import numpy as np
import pandas as pd
df = pd.read_csv('bemt_output.csv')
# V = np.array([
# 0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,
# 16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,
# 30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,
# 44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,
# 58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,
# 72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0
# ])

# T = np.array([
# 842.125002019147,854.2237886137003,842.4327997629734,830.2731711212004,
# 817.7270936882112,804.7485288311287,791.3452574737838,777.6919037233779,
# 763.7418781431636,749.467484770613,734.8615713629304,720.0805600509716,
# 705.1266505738234,689.8266066629027,674.1936894146278,658.4408923306885,
# 642.5942936799878,626.6820980628561,610.1817322675768,593.182748338697,
# 576.2119964107849,559.5072393180377,542.8098129481893,525.7950144996926,
# 507.8496013714002,489.2452526206935,470.95152407400354,453.0652242284151,
# 435.66358993332597,417.9533259030142,399.82023838889745,380.14366985311506,
# 360.16838749489176,340.7916106428704,321.85095738234173,305.6871520722639,
# 287.7905728056822,268.54516015430994,247.97773786730843,227.70190289967564,
# 207.8606454634679,189.16609605074376,171.24563441848088,157.01841664374194,
# 137.864591590521,118.78450205633081,100.35448033821086,82.05058732157109,
# 64.54581589396247,46.26358822261295,28.49927560660461,10.263754827579623,
# -7.185409801926068,-14.882885579879494,-29.661870218636697,-44.6629555581648,
# -59.19430022909103,-73.97327792036424,-88.4016189761904,-103.26003509244394,
# -117.89688499474258,-131.72251517150193,-146.38157615623743,-147.8862875283798,
# -159.0054086647552,-170.23608091044196,-181.129737613522,-192.17938447220877,
# -202.8748473553293,-213.9272260071167,-225.03633565737155,-234.88977511448917,
# -245.46491070644893,-255.80152421020009,-250.71681397834774,-257.7724140282003,
# -265.07023349889545,-272.04635054332095,-279.06040861684096,-286.30048475761845,
# -293.07507291956387,-299.12871520843044,-306.17605890622036,-312.3940460061594,
# -305.1545584262145
# ])
V = df['Velocity (m/s)'].to_numpy()
T = df['Thrust_per_unit_Area'].to_numpy()
# Data arrays V (velocity) and T (thrust per unit area) 
# --- assume you already defined V and T from previous message ---

# Fit a polynomial of degree 5
degree = 5
coeffs = np.polyfit(V, T, degree)

# Create the polynomial function
poly_thrust = np.poly1d(coeffs)

print("Polynomial coefficients:")
print(coeffs)

# Example usage:
v_test = 12.5
print("Thrust at 12.5 m/s =", poly_thrust(v_test))
